{"version":3,"sources":["assets\\Scripts\\bird.js"],"names":["cc","Class","Component","properties","bird_speed","gameOverSp","type","Node","gameStartBtn","Button","flySound","AudioClip","gameOverSound","CollManager","onLoad","touchReceiver","Canvas","instance","node","on","onTouchStart","onTouchEnd","active","EventType","TOUCH_END","touchGameStartBtn","director","getCollisionManager","init","game","onDestroy","off","start","update","dt","gameStatus","GameStatus","Game_Playing","y","gameOver","event","playFlySound","resetScore","spawnNewPipe","resetPipePos","enabled","onCollisionEnter","other","self","audioEngine","playEffect"],"mappings":"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","sourceRoot":"/","sourcesContent":["import { GameStatus } from './enum';\r\ncc.Class({\r\n    extends: cc.Component,\r\n    properties: {\r\n\r\n        // 小鸟移动速度\r\n        bird_speed: 0,\r\n        gameOverSp: {\r\n            default: null,\r\n            type: cc.Node\r\n        },\r\n        gameStartBtn: {\r\n            default: null,\r\n            type: cc.Button,\r\n        },\r\n        // 飞翔音效\r\n        flySound: {\r\n            default: null,\r\n            type: cc.AudioClip,\r\n        },\r\n        gameOverSound: {\r\n            default: null,\r\n            type: cc.AudioClip,\r\n        },\r\n        CollManager: null,\r\n    },\r\n\r\n    // LIFE-CYCLE CALLBACKS:\r\n\r\n    onLoad() {\r\n        // 监听Canvas触摸事件\r\n        var touchReceiver = cc.Canvas.instance.node;\r\n        touchReceiver.on('touchstart', this.onTouchStart, this);\r\n        touchReceiver.on('touchend', this.onTouchEnd, this);\r\n        // 默认不显示游戏结束图\r\n        this.gameOverSp.active = false;\r\n        // 为开始游戏按钮绑定事件\r\n        this.gameStartBtn.node.on(cc.Node.EventType.TOUCH_END, this.touchGameStartBtn, this);\r\n        // 碰撞检测\r\n        this.CollManager = cc.director.getCollisionManager();\r\n    },\r\n    init: function (game) {\r\n        this.game = game;\r\n    },\r\n\r\n    onDestroy() {\r\n\r\n        // 取消触摸事件监听\r\n        var touchReceiver = cc.Canvas.instance.node;\r\n        touchReceiver.off('touchstart', this.onTouchStart, this);\r\n        touchReceiver.off('touchend', this.onTouchEnd, this);\r\n\r\n    },\r\n\r\n    start() {\r\n\r\n    },\r\n\r\n\r\n    update(dt) {\r\n        // 当游戏状态为进行中时开始运动\r\n        if (this.game.gameStatus == GameStatus.Game_Playing) {\r\n            this.bird_speed -= 0.05;\r\n            this.node.y += this.bird_speed;\r\n\r\n            // 判断边界\r\n            if (this.node.y >= 256 || this.node.y <= -256) {\r\n                this.gameOver();\r\n            }\r\n        }\r\n\r\n    },\r\n\r\n    // 触摸开始时\r\n    onTouchStart(event) {\r\n        this.playFlySound();\r\n        this.bird_speed = 2;\r\n    },\r\n\r\n    // 触摸结束时\r\n    onTouchEnd(event) {\r\n        this.bird_speed = 0;\r\n    },\r\n\r\n    // 触摸开始游戏按钮\r\n    touchGameStartBtn(event) {\r\n        // 改变游戏状态\r\n        this.game.gameStatus = GameStatus.Game_Playing;\r\n        // 开始游戏时重置分数\r\n        this.game.resetScore();\r\n        this.game.spawnNewPipe();\r\n        // 开始游戏时重置水管初始位置\r\n        this.game.resetPipePos();\r\n        // 隐藏开始按钮\r\n        this.gameStartBtn.node.active = false;\r\n        //  隐藏游戏结束图\r\n        this.gameOverSp.active = false;\r\n        // this.node.parent.spawnNewPipe()\r\n        this.node.y = 0;\r\n        // 开启碰撞检测\r\n        this.CollManager.enabled = true;\r\n    },\r\n\r\n    /**\r\n     * 当碰撞产生的时候调用\r\n     * @param  {Collider} other 产生碰撞的另一个碰撞组件\r\n     * @param  {Collider} self  产生碰撞的自身的碰撞组件\r\n     */\r\n    onCollisionEnter(other, self) {\r\n        this.gameOver();\r\n    },\r\n\r\n    gameOver() {\r\n        this.game.gameOver();\r\n        // 关闭碰撞检测\r\n        this.CollManager.enabled = false;\r\n        this.gameOverSp.active = true;\r\n        // 显示开始游戏按钮\r\n        this.gameStartBtn.node.active = true;\r\n        // 播放游戏结束音效\r\n        cc.audioEngine.playEffect(this.gameOverSound, false);\r\n    },\r\n    // 播放飞翔音效\r\n    playFlySound() {\r\n        // 若游戏不在进行中则不播放音乐 \r\n        if (this.game.gameStatus != GameStatus.Game_Playing) return;\r\n        cc.audioEngine.playEffect(this.flySound, false);\r\n    },\r\n});\r\n"]}